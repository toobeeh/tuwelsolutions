var tws;(()=>{"use strict";var t={203:function(t,e){var n=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function s(t){try{c(o.next(t))}catch(t){i(t)}}function u(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,u)}c((o=o.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.setSolution=e.getSolutions=void 0,e.getSolutions=function(t){return n(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,fetch("https://tuwelsolution.xerus.at/solution/"+t)];case 1:return[4,e.sent().json()];case 2:return[2,e.sent()]}}))}))},e.setSolution=function(t){return n(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,fetch("https://tuwelsolution.xerus.at/solution/save/",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})];case 1:return e.sent(),[2]}}))}))}},498:function(t,e){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.TuwelMultianswerSolved=e.TuwelMultianswer=void 0;var r=function(){function t(t){var e,n=this;this.question=t;var o=t.querySelector(".formulation").cloneNode(!0);o.querySelectorAll(".subquestion").forEach((function(t){return t.remove()})),this.text=o.textContent,this.image=null===(e=t.querySelector("img"))||void 0===e?void 0:e.src.slice(0,1e4),this.answers=[],t.querySelectorAll(".answer > .subquestion select").forEach((function(t){var e=[];t.querySelectorAll("option").forEach((function(n){e.push({option:n,select:t})})),n.answers.push(e)}))}return t.prototype.matches=function(t){return"multianswer"==t.type&&t.text==this.text&&t.imgHash==this.image},t.prototype.solve=function(t){this.answers.forEach((function(e,n){e.forEach((function(e){e.option.selected=e.option.value==t.answers[n],e.option.selected&&(e.select.value=e.option.value)}))}))},t}();e.TuwelMultianswer=r;var i=function(t){function e(e){var n=t.call(this,e)||this,o=[];return e.querySelectorAll(".feedbackspan").forEach((function(t){o.push(t.innerHTML.split("<br>")[1].split(": ")[1])})),n.correctAnswers=o,n}return o(e,t),e.prototype.toJSON=function(){return{type:"multianswer",text:this.text,imgHash:this.image,answers:this.correctAnswers}},e}(r);e.TuwelMultianswerSolved=i},746:function(t,e){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.TuwelMultichoiceSolved=e.TuwelMultichoice=void 0;var r=function(){function t(t){var e,n=this;this.question=t,this.text=t.querySelector(".qtext").innerText,this.image=null===(e=t.querySelector("img"))||void 0===e?void 0:e.src.slice(0,1e4),this.answers=[],t.querySelectorAll(".answer > div").forEach((function(t){n.answers.push({text:t.innerText,element:t.querySelector("input:nth-child(2)")})}))}return t.prototype.matches=function(t){return"multichoice"==t.type&&t.text==this.text&&t.imgHash==this.image},t.prototype.solve=function(t){this.answers.forEach((function(e){t.answers.some((function(t){return e.text==t}))&&e.element.click()}))},t}();e.TuwelMultichoice=r;var i=function(t){function e(e){var n=t.call(this,e)||this,o=e.querySelector(".rightanswer").innerText;return n.correctAnswers=o.substring(o.indexOf(":")+1).trim().split(",").map((function(t){return t.trim()})),n}return o(e,t),e.prototype.toJSON=function(){return{type:"multichoice",text:this.text,imgHash:this.image,answers:this.correctAnswers}},e}(r);e.TuwelMultichoiceSolved=i},698:function(t,e,n){var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function s(t){try{c(o.next(t))}catch(t){i(t)}}function u(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,u)}c((o=o.apply(t,e||[])).next())}))},r=this&&this.__generator||function(t,e){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.setup=e.processQuizResult=e.solveQuiz=void 0;var i=n(203),s=n(498),u=n(746);function c(){return o(this,void 0,void 0,(function(){var t,e;return r(this,(function(n){switch(n.label){case 0:t=window.location.search.replace("?","").split("&").find((function(t){return t.indexOf("cmid")>=0})).replace("cmid=",""),e=void 0,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,(0,i.getSolutions)(t)];case 2:return e=n.sent(),[3,4];case 3:return n.sent(),console.timeLog("No solutions for this quiz :/"),[2];case 4:return console.log("found solutions for this quiz: ",e),document.querySelectorAll(".que").forEach((function(t){if(t.classList.contains("multichoice")){var n=new u.TuwelMultichoice(t);null==e||e.questions.forEach((function(t){n.matches(t)&&(n.solve(t),console.log("solved a question:",n))}))}if(t.classList.contains("multianswer")){var o=new s.TuwelMultianswer(t);null==e||e.questions.forEach((function(t){o.matches(t)&&(o.solve(t),console.log("solved a question:",o))}))}})),console.log("solved all known questions"),[2]}}))}))}function l(){return o(this,void 0,void 0,(function(){var t,e,n;return r(this,(function(o){switch(o.label){case 0:return t=window.location.search.replace("?","").split("&").find((function(t){return t.indexOf("cmid")>=0})).replace("cmid=",""),e=[],document.querySelectorAll(".que").forEach((function(t){t.classList.contains("multichoice")?e.push(new u.TuwelMultichoiceSolved(t).toJSON()):t.classList.contains("multianswer")&&e.push(new s.TuwelMultianswerSolved(t).toJSON())})),n={quiz:t,questions:e},[4,(0,i.setSolution)(n)];case 1:return o.sent(),[2]}}))}))}e.solveQuiz=c,e.processQuizResult=l,e.setup=function(){var t=document.querySelector(".othernav"),e=document.createElement("a");e.href="#";var n=window.location.pathname.split("/").reverse()[0];"attempt.php"==n?(e.innerText="Load from tuwelsolutions",e.addEventListener("click",c),t.appendChild(e)):"review.php"==n&&(e.innerText="Upload to tuwelsolutions",e.addEventListener("click",l),t.appendChild(e))}}},e={},n=function n(o){var r=e[o];if(void 0!==r)return r.exports;var i=e[o]={exports:{}};return t[o].call(i.exports,i,i.exports,n),i.exports}(698);tws=n})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VUFwQzVCZ0IsRUFBUTBFLFVBQVlBLEVBeUNwQjFFLEVBQVF5RSxrQkFBb0JBLEVBa0I1QnpFLEVBQVF3RSxNQWhCUixXQUNJLElBQUkyQixFQUFNUixTQUFTNUQsY0FBYyxhQUM3QnFFLEVBQWFULFNBQVNVLGNBQWMsS0FDeENELEVBQVdFLEtBQU8sSUFDbEIsSUFBSUMsRUFBT3RCLE9BQU9DLFNBQVNzQixTQUFTL0MsTUFBTSxLQUFLZ0QsVUFBVSxHQUM3QyxlQUFSRixHQUNBSCxFQUFXdEMsVUFBWSwyQkFDdkJzQyxFQUFXTSxpQkFBaUIsUUFBU2hDLEdBQ3JDeUIsRUFBSVEsWUFBWVAsSUFFSCxjQUFSRyxJQUNMSCxFQUFXdEMsVUFBWSwyQkFDdkJzQyxFQUFXTSxpQkFBaUIsUUFBU2pDLEdBQ3JDMEIsRUFBSVEsWUFBWVAsT0N6SnBCUSxFQUEyQixHQ0UzQkMsRURDSixTQUFTQyxFQUFvQkMsR0FFNUIsSUFBSUMsRUFBZUosRUFBeUJHLEdBQzVDLFFBQXFCeEIsSUFBakJ5QixFQUNILE9BQU9BLEVBQWFoSCxRQUdyQixJQUFJaUgsRUFBU0wsRUFBeUJHLEdBQVksQ0FHakQvRyxRQUFTLElBT1YsT0FIQWtILEVBQW9CSCxHQUFVckgsS0FBS3VILEVBQU9qSCxRQUFTaUgsRUFBUUEsRUFBT2pILFFBQVM4RyxHQUdwRUcsRUFBT2pILFFDbEJXOEcsQ0FBb0IsSyIsInNvdXJjZXMiOlsid2VicGFjazovL3R3cy8uL3NyYy9hcGkudHMiLCJ3ZWJwYWNrOi8vdHdzLy4vc3JjL211bHRpYW5zd2VyLnRzIiwid2VicGFjazovL3R3cy8uL3NyYy9tdWx0aWNob2ljZS50cyIsIndlYnBhY2s6Ly90d3MvLi9zcmMvdHV3ZWxzb2x1dGlvbnMudHMiLCJ3ZWJwYWNrOi8vdHdzL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3R3cy93ZWJwYWNrL3N0YXJ0dXAiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XHJcbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufTtcclxudmFyIF9fZ2VuZXJhdG9yID0gKHRoaXMgJiYgdGhpcy5fX2dlbmVyYXRvcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XHJcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xyXG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxyXG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xyXG4gICAgfVxyXG59O1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmV4cG9ydHMuc2V0U29sdXRpb24gPSBleHBvcnRzLmdldFNvbHV0aW9ucyA9IHZvaWQgMDtcclxuZnVuY3Rpb24gZ2V0U29sdXRpb25zKGlkKSB7XHJcbiAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHJlc3BvbnNlLCBzb2x1dGlvbnM7XHJcbiAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIGZldGNoKFwiaHR0cHM6Ly90dXdlbHNvbHV0aW9uLnhlcnVzLmF0L3NvbHV0aW9uL1wiICsgaWQpXTtcclxuICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICByZXNwb25zZSA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCByZXNwb25zZS5qc29uKCldO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgIHNvbHV0aW9ucyA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgc29sdXRpb25zXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuZXhwb3J0cy5nZXRTb2x1dGlvbnMgPSBnZXRTb2x1dGlvbnM7XHJcbmZ1bmN0aW9uIHNldFNvbHV0aW9uKHF1aXopIHtcclxuICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgZmV0Y2goJ2h0dHBzOi8vdHV3ZWxzb2x1dGlvbi54ZXJ1cy5hdC9zb2x1dGlvbi9zYXZlLycsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUFVUJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShxdWl6KVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXTtcclxuICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufVxyXG5leHBvcnRzLnNldFNvbHV0aW9uID0gc2V0U29sdXRpb247XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG52YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XHJcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcclxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xyXG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG4gICAgfTtcclxufSkoKTtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5leHBvcnRzLlR1d2VsTXVsdGlhbnN3ZXJTb2x2ZWQgPSBleHBvcnRzLlR1d2VsTXVsdGlhbnN3ZXIgPSB2b2lkIDA7XHJcbi8qKiBiYXNlIGNsYXNzIGZvciB0dXdlbCBtdWx0aWFuc3dlciBxdWVzdGlvbnMgKi9cclxudmFyIFR1d2VsTXVsdGlhbnN3ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBUdXdlbE11bHRpYW5zd2VyKHF1ZXN0aW9uKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgdGhpcy5xdWVzdGlvbiA9IHF1ZXN0aW9uO1xyXG4gICAgICAgIHZhciBmb3JtdWxhdGlvbiA9IHF1ZXN0aW9uLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybXVsYXRpb25cIikuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgICAgIGZvcm11bGF0aW9uLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc3VicXVlc3Rpb25cIikuZm9yRWFjaChmdW5jdGlvbiAocykgeyByZXR1cm4gcy5yZW1vdmUoKTsgfSk7XHJcbiAgICAgICAgdGhpcy50ZXh0ID0gZm9ybXVsYXRpb24udGV4dENvbnRlbnQ7XHJcbiAgICAgICAgdGhpcy5pbWFnZSA9IChfYSA9IHF1ZXN0aW9uLnF1ZXJ5U2VsZWN0b3IoXCJpbWdcIikpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zcmMuc2xpY2UoMCwgMTAwMDApO1xyXG4gICAgICAgIHRoaXMuYW5zd2VycyA9IFtdO1xyXG4gICAgICAgIHF1ZXN0aW9uLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYW5zd2VyID4gLnN1YnF1ZXN0aW9uIHNlbGVjdFwiKS5mb3JFYWNoKGZ1bmN0aW9uIChzZWxlY3QpIHtcclxuICAgICAgICAgICAgdmFyIG9wdHMgPSBbXTtcclxuICAgICAgICAgICAgc2VsZWN0LnF1ZXJ5U2VsZWN0b3JBbGwoXCJvcHRpb25cIikuZm9yRWFjaChmdW5jdGlvbiAob3B0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICBvcHRzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbjogb3B0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdDogc2VsZWN0XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIF90aGlzLmFuc3dlcnMucHVzaChvcHRzKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogZXZhbHVhdGVzIGlmIHRoaXMgcXVlc3Rpb24gaXMgZXF1YWwgdG8gYW5vdGhlclxyXG4gICAgICogQHBhcmFtIHF1ZXN0aW9uXHJcbiAgICAgKi9cclxuICAgIFR1d2VsTXVsdGlhbnN3ZXIucHJvdG90eXBlLm1hdGNoZXMgPSBmdW5jdGlvbiAocXVlc3Rpb24pIHtcclxuICAgICAgICByZXR1cm4gcXVlc3Rpb24udHlwZSA9PSBcIm11bHRpYW5zd2VyXCIgJiYgcXVlc3Rpb24udGV4dCA9PSB0aGlzLnRleHQgJiYgcXVlc3Rpb24uaW1nSGFzaCA9PSB0aGlzLmltYWdlO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogdGlja3MgdGhlIHByb3ZpZGVkIGNvcnJlY3Qgc29sdXRpb25zIG9mIGFuIHF1ZXN0aW9ucyBhbnN3ZXJcclxuICAgICAqIEBwYXJhbSBzb2x1dGlvbiB0aGUgc29sdXRpb25zIGZvciB0aGlzIHF1ZXN0aW9uXHJcbiAgICAgKi9cclxuICAgIFR1d2VsTXVsdGlhbnN3ZXIucHJvdG90eXBlLnNvbHZlID0gZnVuY3Rpb24gKHNvbHV0aW9uKSB7XHJcbiAgICAgICAgLyogbG9vcCB0aHJvdWdoIGF2YWlsYWJsZSBhbnN3ZXJzICovXHJcbiAgICAgICAgdGhpcy5hbnN3ZXJzLmZvckVhY2goZnVuY3Rpb24gKHN1YnF1ZXN0aW9uLCBpbmRleCkge1xyXG4gICAgICAgICAgICAvKiBzZXQgc2VsZWN0IHZhbHVlICovXHJcbiAgICAgICAgICAgIHN1YnF1ZXN0aW9uLmZvckVhY2goZnVuY3Rpb24gKHMpIHtcclxuICAgICAgICAgICAgICAgIHMub3B0aW9uLnNlbGVjdGVkID0gcy5vcHRpb24udmFsdWUgPT0gc29sdXRpb24uYW5zd2Vyc1tpbmRleF07XHJcbiAgICAgICAgICAgICAgICBpZiAocy5vcHRpb24uc2VsZWN0ZWQpXHJcbiAgICAgICAgICAgICAgICAgICAgcy5zZWxlY3QudmFsdWUgPSBzLm9wdGlvbi52YWx1ZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFR1d2VsTXVsdGlhbnN3ZXI7XHJcbn0oKSk7XHJcbmV4cG9ydHMuVHV3ZWxNdWx0aWFuc3dlciA9IFR1d2VsTXVsdGlhbnN3ZXI7XHJcbi8qKiBjbGFzcyB0byBoYW5kbGUgYSBtdWx0aWNob2ljZSByZXN1bHQgKi9cclxudmFyIFR1d2VsTXVsdGlhbnN3ZXJTb2x2ZWQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICBfX2V4dGVuZHMoVHV3ZWxNdWx0aWFuc3dlclNvbHZlZCwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIFR1d2VsTXVsdGlhbnN3ZXJTb2x2ZWQocXVlc3Rpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBxdWVzdGlvbikgfHwgdGhpcztcclxuICAgICAgICB2YXIgc29sdXRpb24gPSBbXTtcclxuICAgICAgICBxdWVzdGlvbi5xdWVyeVNlbGVjdG9yQWxsKFwiLmZlZWRiYWNrc3BhblwiKS5mb3JFYWNoKGZ1bmN0aW9uIChzdWJxKSB7XHJcbiAgICAgICAgICAgIHNvbHV0aW9uLnB1c2goc3VicS5pbm5lckhUTUwuc3BsaXQoXCI8YnI+XCIpWzFdLnNwbGl0KFwiOiBcIilbMV0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIF90aGlzLmNvcnJlY3RBbnN3ZXJzID0gc29sdXRpb247XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBjb252ZXJ0cyB0aGlzIHF1ZXN0aW9uIHRvIHRoZSBkYiBqc29uIGludGVyZmFjZVxyXG4gICAgICogQHJldHVybnMgcXVlc3Rpb24gb2JqZWN0XHJcbiAgICAgKi9cclxuICAgIFR1d2VsTXVsdGlhbnN3ZXJTb2x2ZWQucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB0eXBlOiBcIm11bHRpYW5zd2VyXCIsXHJcbiAgICAgICAgICAgIHRleHQ6IHRoaXMudGV4dCxcclxuICAgICAgICAgICAgaW1nSGFzaDogdGhpcy5pbWFnZSxcclxuICAgICAgICAgICAgYW5zd2VyczogdGhpcy5jb3JyZWN0QW5zd2Vyc1xyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFR1d2VsTXVsdGlhbnN3ZXJTb2x2ZWQ7XHJcbn0oVHV3ZWxNdWx0aWFuc3dlcikpO1xyXG5leHBvcnRzLlR1d2VsTXVsdGlhbnN3ZXJTb2x2ZWQgPSBUdXdlbE11bHRpYW5zd2VyU29sdmVkO1xyXG4iLCJcInVzZSBzdHJpY3RcIjtcclxudmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xyXG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xyXG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcclxuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxuICAgIH07XHJcbn0pKCk7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5UdXdlbE11bHRpY2hvaWNlU29sdmVkID0gZXhwb3J0cy5UdXdlbE11bHRpY2hvaWNlID0gdm9pZCAwO1xyXG4vKiogYmFzZSBjbGFzcyBmb3IgdHV3ZWwgbXVsdGljaG9pY2UgcXVlc3Rpb25zICovXHJcbnZhciBUdXdlbE11bHRpY2hvaWNlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gVHV3ZWxNdWx0aWNob2ljZShxdWVzdGlvbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgIHRoaXMucXVlc3Rpb24gPSBxdWVzdGlvbjtcclxuICAgICAgICB0aGlzLnRleHQgPSBxdWVzdGlvbi5xdWVyeVNlbGVjdG9yKFwiLnF0ZXh0XCIpLmlubmVyVGV4dDtcclxuICAgICAgICB0aGlzLmltYWdlID0gKF9hID0gcXVlc3Rpb24ucXVlcnlTZWxlY3RvcihcImltZ1wiKSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnNyYy5zbGljZSgwLCAxMDAwMCk7XHJcbiAgICAgICAgdGhpcy5hbnN3ZXJzID0gW107XHJcbiAgICAgICAgcXVlc3Rpb24ucXVlcnlTZWxlY3RvckFsbChcIi5hbnN3ZXIgPiBkaXZcIikuZm9yRWFjaChmdW5jdGlvbiAoYW5zd2VyKSB7XHJcbiAgICAgICAgICAgIF90aGlzLmFuc3dlcnMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICB0ZXh0OiBhbnN3ZXIuaW5uZXJUZXh0LFxyXG4gICAgICAgICAgICAgICAgZWxlbWVudDogYW5zd2VyLnF1ZXJ5U2VsZWN0b3IoXCJpbnB1dDpudGgtY2hpbGQoMilcIilcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIGV2YWx1YXRlcyBpZiB0aGlzIHF1ZXN0aW9uIGlzIGVxdWFsIHRvIGFub3RoZXJcclxuICAgICAqIEBwYXJhbSBxdWVzdGlvblxyXG4gICAgICovXHJcbiAgICBUdXdlbE11bHRpY2hvaWNlLnByb3RvdHlwZS5tYXRjaGVzID0gZnVuY3Rpb24gKHF1ZXN0aW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIHF1ZXN0aW9uLnR5cGUgPT0gXCJtdWx0aWNob2ljZVwiICYmIHF1ZXN0aW9uLnRleHQgPT0gdGhpcy50ZXh0ICYmIHF1ZXN0aW9uLmltZ0hhc2ggPT0gdGhpcy5pbWFnZTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIHRpY2tzIHRoZSBwcm92aWRlZCBjb3JyZWN0IHNvbHV0aW9ucyBvZiBhbiBxdWVzdGlvbnMgYW5zd2VyXHJcbiAgICAgKiBAcGFyYW0gc29sdXRpb24gdGhlIHNvbHV0aW9ucyBmb3IgdGhpcyBxdWVzdGlvblxyXG4gICAgICovXHJcbiAgICBUdXdlbE11bHRpY2hvaWNlLnByb3RvdHlwZS5zb2x2ZSA9IGZ1bmN0aW9uIChzb2x1dGlvbikge1xyXG4gICAgICAgIC8qIGxvb3AgdGhyb3VnaCBhdmFpbGFibGUgYW5zd2VycyAqL1xyXG4gICAgICAgIHRoaXMuYW5zd2Vycy5mb3JFYWNoKGZ1bmN0aW9uIChhbnN3ZXIpIHtcclxuICAgICAgICAgICAgLyogaWYgYW5zd2VyIGlzIGluIGNvcnJlY3QgYW5zd2VycywgY2xpY2sgaXQgKi9cclxuICAgICAgICAgICAgaWYgKHNvbHV0aW9uLmFuc3dlcnMuc29tZShmdW5jdGlvbiAodGV4dCkgeyByZXR1cm4gYW5zd2VyLnRleHQgPT0gdGV4dDsgfSkpIHtcclxuICAgICAgICAgICAgICAgIGFuc3dlci5lbGVtZW50LmNsaWNrKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gVHV3ZWxNdWx0aWNob2ljZTtcclxufSgpKTtcclxuZXhwb3J0cy5UdXdlbE11bHRpY2hvaWNlID0gVHV3ZWxNdWx0aWNob2ljZTtcclxuLyoqIGNsYXNzIHRvIGhhbmRsZSBhIG11bHRpY2hvaWNlIHJlc3VsdCAqL1xyXG52YXIgVHV3ZWxNdWx0aWNob2ljZVNvbHZlZCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIF9fZXh0ZW5kcyhUdXdlbE11bHRpY2hvaWNlU29sdmVkLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gVHV3ZWxNdWx0aWNob2ljZVNvbHZlZChxdWVzdGlvbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHF1ZXN0aW9uKSB8fCB0aGlzO1xyXG4gICAgICAgIHZhciBzb2x1dGlvbiA9IHF1ZXN0aW9uLnF1ZXJ5U2VsZWN0b3IoXCIucmlnaHRhbnN3ZXJcIikuaW5uZXJUZXh0O1xyXG4gICAgICAgIF90aGlzLmNvcnJlY3RBbnN3ZXJzID0gc29sdXRpb25cclxuICAgICAgICAgICAgLnN1YnN0cmluZyhzb2x1dGlvbi5pbmRleE9mKFwiOlwiKSArIDEpXHJcbiAgICAgICAgICAgIC50cmltKClcclxuICAgICAgICAgICAgLnNwbGl0KFwiLFwiKVxyXG4gICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChhKSB7IHJldHVybiBhLnRyaW0oKTsgfSk7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBjb252ZXJ0cyB0aGlzIHF1ZXN0aW9uIHRvIHRoZSBkYiBqc29uIGludGVyZmFjZVxyXG4gICAgICogQHJldHVybnMgcXVlc3Rpb24gb2JqZWN0XHJcbiAgICAgKi9cclxuICAgIFR1d2VsTXVsdGljaG9pY2VTb2x2ZWQucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB0eXBlOiBcIm11bHRpY2hvaWNlXCIsXHJcbiAgICAgICAgICAgIHRleHQ6IHRoaXMudGV4dCxcclxuICAgICAgICAgICAgaW1nSGFzaDogdGhpcy5pbWFnZSxcclxuICAgICAgICAgICAgYW5zd2VyczogdGhpcy5jb3JyZWN0QW5zd2Vyc1xyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFR1d2VsTXVsdGljaG9pY2VTb2x2ZWQ7XHJcbn0oVHV3ZWxNdWx0aWNob2ljZSkpO1xyXG5leHBvcnRzLlR1d2VsTXVsdGljaG9pY2VTb2x2ZWQgPSBUdXdlbE11bHRpY2hvaWNlU29sdmVkO1xyXG4iLCJcInVzZSBzdHJpY3RcIjtcclxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59O1xyXG52YXIgX19nZW5lcmF0b3IgPSAodGhpcyAmJiB0aGlzLl9fZ2VuZXJhdG9yKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgYm9keSkge1xyXG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcclxuICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCBcInRocm93XCI6IHZlcmIoMSksIFwicmV0dXJuXCI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XHJcbiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xyXG4gICAgICAgIHdoaWxlIChfKSB0cnkge1xyXG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XHJcbiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcclxuICAgICAgICAgICAgc3dpdGNoIChvcFswXSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xyXG4gICAgICAgICAgICAgICAgY2FzZSA1OiBfLmxhYmVsKys7IHkgPSBvcFsxXTsgb3AgPSBbMF07IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoISh0ID0gXy50cnlzLCB0ID0gdC5sZW5ndGggPiAwICYmIHRbdC5sZW5ndGggLSAxXSkgJiYgKG9wWzBdID09PSA2IHx8IG9wWzBdID09PSAyKSkgeyBfID0gMDsgY29udGludWU7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7IF8ubGFiZWwgPSB0WzJdOyBfLm9wcy5wdXNoKG9wKTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XHJcbiAgICAgICAgaWYgKG9wWzBdICYgNSkgdGhyb3cgb3BbMV07IHJldHVybiB7IHZhbHVlOiBvcFswXSA/IG9wWzFdIDogdm9pZCAwLCBkb25lOiB0cnVlIH07XHJcbiAgICB9XHJcbn07XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5zZXR1cCA9IGV4cG9ydHMucHJvY2Vzc1F1aXpSZXN1bHQgPSBleHBvcnRzLnNvbHZlUXVpeiA9IHZvaWQgMDtcclxudmFyIGFwaV8xID0gcmVxdWlyZShcIi4vYXBpXCIpO1xyXG52YXIgbXVsdGlhbnN3ZXJfMSA9IHJlcXVpcmUoXCIuL211bHRpYW5zd2VyXCIpO1xyXG52YXIgbXVsdGljaG9pY2VfMSA9IHJlcXVpcmUoXCIuL211bHRpY2hvaWNlXCIpO1xyXG5mdW5jdGlvbiBzb2x2ZVF1aXooKSB7XHJcbiAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHF1aXpJRCwgY3VycmVudFNvbHV0aW9uLCBfYTtcclxuICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAoX2IubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICBxdWl6SUQgPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiP1wiLCBcIlwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3BsaXQoXCImXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kKGZ1bmN0aW9uIChwYXJhbSkgeyByZXR1cm4gcGFyYW0uaW5kZXhPZihcImNtaWRcIikgPj0gMDsgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoXCJjbWlkPVwiLCBcIlwiKTtcclxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50U29sdXRpb24gPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgX2IubGFiZWwgPSAxO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgIF9iLnRyeXMucHVzaChbMSwgMywgLCA0XSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgKDAsIGFwaV8xLmdldFNvbHV0aW9ucykocXVpeklEKV07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFNvbHV0aW9uID0gX2Iuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgIF9hID0gX2Iuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUudGltZUxvZyhcIk5vIHNvbHV0aW9ucyBmb3IgdGhpcyBxdWl6IDovXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImZvdW5kIHNvbHV0aW9ucyBmb3IgdGhpcyBxdWl6OiBcIiwgY3VycmVudFNvbHV0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBnZXQgcXVlc3Rpb25zIGZyb20gZG9jdW1lbnQgYW5kIHNvbHZlIHRoZW1cclxuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnF1ZVwiKS5mb3JFYWNoKGZ1bmN0aW9uIChxdWVzdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiBpdCdzIGEgbXVsdGlwbGUgY2hvaWNlIHF1ZXN0aW9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChxdWVzdGlvbi5jbGFzc0xpc3QuY29udGFpbnMoXCJtdWx0aWNob2ljZVwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNoZWNrUXVlc3Rpb25fMSA9IG5ldyBtdWx0aWNob2ljZV8xLlR1d2VsTXVsdGljaG9pY2UocXVlc3Rpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VhcmNoIGZvciBtYXRjaGluZyBzb2x1dGlvbnNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTb2x1dGlvbiA9PT0gbnVsbCB8fCBjdXJyZW50U29sdXRpb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IGN1cnJlbnRTb2x1dGlvbi5xdWVzdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoc29sdXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hlY2tRdWVzdGlvbl8xLm1hdGNoZXMoc29sdXRpb24pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrUXVlc3Rpb25fMS5zb2x2ZShzb2x1dGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwic29sdmVkIGEgcXVlc3Rpb246XCIsIGNoZWNrUXVlc3Rpb25fMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgaXQncyBhIG11bHRpYW5zd2VyIHF1ZXN0aW9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChxdWVzdGlvbi5jbGFzc0xpc3QuY29udGFpbnMoXCJtdWx0aWFuc3dlclwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGVjdHF1ZXN0aW9uXzEgPSBuZXcgbXVsdGlhbnN3ZXJfMS5UdXdlbE11bHRpYW5zd2VyKHF1ZXN0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlYXJjaCBmb3IgbWF0Y2hpbmcgc29sdXRpb25zXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U29sdXRpb24gPT09IG51bGwgfHwgY3VycmVudFNvbHV0aW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjdXJyZW50U29sdXRpb24ucXVlc3Rpb25zLmZvckVhY2goZnVuY3Rpb24gKHNvbHV0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdHF1ZXN0aW9uXzEubWF0Y2hlcyhzb2x1dGlvbikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0cXVlc3Rpb25fMS5zb2x2ZShzb2x1dGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwic29sdmVkIGEgcXVlc3Rpb246XCIsIHNlbGVjdHF1ZXN0aW9uXzEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJzb2x2ZWQgYWxsIGtub3duIHF1ZXN0aW9uc1wiKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcbmV4cG9ydHMuc29sdmVRdWl6ID0gc29sdmVRdWl6O1xyXG4vKipcclxuICogUHJvY2VzcyBhIHF1aXogcmVzdWx0IG9uIHRoZSBcIlRVV0VMIHJlc3VsdCBwYWdlXCJcclxuICogZ2V0cyB0aGUgY29ycmVjdCBhbnN3ZXJzLCBtZXJnZXMgd2l0aCBjdXJyZW50IGFuc3dlcnMgb24gdGhlIHNlcnZlciBhbmQgcG9zdHMgdGhlIG1lcmdlXHJcbiAqL1xyXG5mdW5jdGlvbiBwcm9jZXNzUXVpelJlc3VsdCgpIHtcclxuICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgcXVpeklELCBzb2x1dGlvbnMsIHNvbHZlZFF1aXo7XHJcbiAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgcXVpeklEID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZShcIj9cIiwgXCJcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnNwbGl0KFwiJlwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZmluZChmdW5jdGlvbiAocGFyYW0pIHsgcmV0dXJuIHBhcmFtLmluZGV4T2YoXCJjbWlkXCIpID49IDA7IH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiY21pZD1cIiwgXCJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgc29sdXRpb25zID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5xdWVcIikuZm9yRWFjaChmdW5jdGlvbiAocXVlc3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgaXQncyBhIG11bHRpcGxlIGNob2ljZSBxdWVzdGlvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocXVlc3Rpb24uY2xhc3NMaXN0LmNvbnRhaW5zKFwibXVsdGljaG9pY2VcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvbHV0aW9ucy5wdXNoKG5ldyBtdWx0aWNob2ljZV8xLlR1d2VsTXVsdGljaG9pY2VTb2x2ZWQocXVlc3Rpb24pLnRvSlNPTigpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiBpdCdzIGEgc2VsZWN0IHF1ZXN0aW9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHF1ZXN0aW9uLmNsYXNzTGlzdC5jb250YWlucyhcIm11bHRpYW5zd2VyXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb2x1dGlvbnMucHVzaChuZXcgbXVsdGlhbnN3ZXJfMS5UdXdlbE11bHRpYW5zd2VyU29sdmVkKHF1ZXN0aW9uKS50b0pTT04oKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBzb2x2ZWRRdWl6ID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWl6OiBxdWl6SUQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXN0aW9uczogc29sdXRpb25zXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBwb3N0IHRvIHNlcnZlclxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sICgwLCBhcGlfMS5zZXRTb2x1dGlvbikoc29sdmVkUXVpeildO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHBvc3QgdG8gc2VydmVyXHJcbiAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuZXhwb3J0cy5wcm9jZXNzUXVpelJlc3VsdCA9IHByb2Nlc3NRdWl6UmVzdWx0O1xyXG4vKiogY29ubmVjdHMgdHV3ZWxzb2x1dGlvbiBmdW5jdGlvbnMgdG8gdGhlIFVJICovXHJcbmZ1bmN0aW9uIHNldHVwKCkge1xyXG4gICAgdmFyIG5hdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIub3RoZXJuYXZcIik7XHJcbiAgICB2YXIgYWN0aW9uRWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhXCIpO1xyXG4gICAgYWN0aW9uRWxlbS5ocmVmID0gXCIjXCI7XHJcbiAgICB2YXIgbW9kZSA9IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5zcGxpdChcIi9cIikucmV2ZXJzZSgpWzBdO1xyXG4gICAgaWYgKG1vZGUgPT0gXCJhdHRlbXB0LnBocFwiKSB7XHJcbiAgICAgICAgYWN0aW9uRWxlbS5pbm5lclRleHQgPSBcIkxvYWQgZnJvbSB0dXdlbHNvbHV0aW9uc1wiO1xyXG4gICAgICAgIGFjdGlvbkVsZW0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHNvbHZlUXVpeik7XHJcbiAgICAgICAgbmF2LmFwcGVuZENoaWxkKGFjdGlvbkVsZW0pO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAobW9kZSA9PSBcInJldmlldy5waHBcIikge1xyXG4gICAgICAgIGFjdGlvbkVsZW0uaW5uZXJUZXh0ID0gXCJVcGxvYWQgdG8gdHV3ZWxzb2x1dGlvbnNcIjtcclxuICAgICAgICBhY3Rpb25FbGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBwcm9jZXNzUXVpelJlc3VsdCk7XHJcbiAgICAgICAgbmF2LmFwcGVuZENoaWxkKGFjdGlvbkVsZW0pO1xyXG4gICAgfVxyXG59XHJcbmV4cG9ydHMuc2V0dXAgPSBzZXR1cDtcclxuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIHN0YXJ0dXBcbi8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLy8gVGhpcyBlbnRyeSBtb2R1bGUgaXMgcmVmZXJlbmNlZCBieSBvdGhlciBtb2R1bGVzIHNvIGl0IGNhbid0IGJlIGlubGluZWRcbnZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2OTgpO1xuIl0sIm5hbWVzIjpbIl9fYXdhaXRlciIsInRoaXMiLCJ0aGlzQXJnIiwiX2FyZ3VtZW50cyIsIlAiLCJnZW5lcmF0b3IiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImZ1bGZpbGxlZCIsInZhbHVlIiwic3RlcCIsIm5leHQiLCJlIiwicmVqZWN0ZWQiLCJyZXN1bHQiLCJkb25lIiwidGhlbiIsImFwcGx5IiwiX19nZW5lcmF0b3IiLCJib2R5IiwiZiIsInkiLCJ0IiwiZyIsIl8iLCJsYWJlbCIsInNlbnQiLCJ0cnlzIiwib3BzIiwidmVyYiIsIlN5bWJvbCIsIml0ZXJhdG9yIiwibiIsInYiLCJvcCIsIlR5cGVFcnJvciIsImNhbGwiLCJwb3AiLCJsZW5ndGgiLCJwdXNoIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJleHBvcnRzIiwic2V0U29sdXRpb24iLCJnZXRTb2x1dGlvbnMiLCJpZCIsIl9hIiwiZmV0Y2giLCJqc29uIiwicXVpeiIsIm1ldGhvZCIsImhlYWRlcnMiLCJKU09OIiwic3RyaW5naWZ5IiwiZXh0ZW5kU3RhdGljcyIsIl9fZXh0ZW5kcyIsImQiLCJiIiwic2V0UHJvdG90eXBlT2YiLCJfX3Byb3RvX18iLCJBcnJheSIsInAiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsIlN0cmluZyIsIl9fIiwiY29uc3RydWN0b3IiLCJjcmVhdGUiLCJUdXdlbE11bHRpYW5zd2VyU29sdmVkIiwiVHV3ZWxNdWx0aWFuc3dlciIsInF1ZXN0aW9uIiwiX3RoaXMiLCJmb3JtdWxhdGlvbiIsInF1ZXJ5U2VsZWN0b3IiLCJjbG9uZU5vZGUiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsInMiLCJyZW1vdmUiLCJ0ZXh0IiwidGV4dENvbnRlbnQiLCJpbWFnZSIsInNyYyIsInNsaWNlIiwiYW5zd2VycyIsInNlbGVjdCIsIm9wdHMiLCJvcHRpb24iLCJtYXRjaGVzIiwidHlwZSIsImltZ0hhc2giLCJzb2x2ZSIsInNvbHV0aW9uIiwic3VicXVlc3Rpb24iLCJpbmRleCIsInNlbGVjdGVkIiwiX3N1cGVyIiwic3VicSIsImlubmVySFRNTCIsInNwbGl0IiwiY29ycmVjdEFuc3dlcnMiLCJ0b0pTT04iLCJUdXdlbE11bHRpY2hvaWNlU29sdmVkIiwiVHV3ZWxNdWx0aWNob2ljZSIsImlubmVyVGV4dCIsImFuc3dlciIsImVsZW1lbnQiLCJzb21lIiwiY2xpY2siLCJzdWJzdHJpbmciLCJpbmRleE9mIiwidHJpbSIsIm1hcCIsImEiLCJzZXR1cCIsInByb2Nlc3NRdWl6UmVzdWx0Iiwic29sdmVRdWl6IiwiYXBpXzEiLCJtdWx0aWFuc3dlcl8xIiwibXVsdGljaG9pY2VfMSIsInF1aXpJRCIsImN1cnJlbnRTb2x1dGlvbiIsIl9iIiwid2luZG93IiwibG9jYXRpb24iLCJzZWFyY2giLCJyZXBsYWNlIiwiZmluZCIsInBhcmFtIiwidW5kZWZpbmVkIiwiY29uc29sZSIsInRpbWVMb2ciLCJsb2ciLCJkb2N1bWVudCIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwiY2hlY2tRdWVzdGlvbl8xIiwicXVlc3Rpb25zIiwic2VsZWN0cXVlc3Rpb25fMSIsInNvbHV0aW9ucyIsInNvbHZlZFF1aXoiLCJuYXYiLCJhY3Rpb25FbGVtIiwiY3JlYXRlRWxlbWVudCIsImhyZWYiLCJtb2RlIiwicGF0aG5hbWUiLCJyZXZlcnNlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImFwcGVuZENoaWxkIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX2V4cG9ydHNfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iXSwic291cmNlUm9vdCI6IiJ9