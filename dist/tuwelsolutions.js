var tws;(()=>{"use strict";var t={203:function(t,e){var n=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function s(t){try{c(o.next(t))}catch(t){i(t)}}function u(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,u)}c((o=o.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.setSolution=e.getSolutions=void 0,e.getSolutions=function(t){return n(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,fetch("https://tuwelsolution.xerus.at/solution/"+t)];case 1:return[4,e.sent().json()];case 2:return[2,e.sent()]}}))}))},e.setSolution=function(t){return n(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,fetch("https://tuwelsolution.xerus.at/solution/save/",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})];case 1:return e.sent(),[2]}}))}))}},498:function(t,e){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.TuwelMultianswerSolved=e.TuwelMultianswer=void 0;var r=function(){function t(t){var e,n=this;this.question=t;var o=t.querySelector(".formulation").cloneNode(!0);o.querySelectorAll(".subquestion").forEach((function(t){return t.remove()})),this.text=o.textContent,this.image=null===(e=t.querySelector("img"))||void 0===e?void 0:e.src.slice(0,1e4),this.answers=[],t.querySelectorAll(".subquestion select").forEach((function(t){var e=[];t.querySelectorAll("option").forEach((function(n){e.push({option:n,select:t})})),n.answers.push(e)}))}return t.prototype.matches=function(t){return"multianswer"==t.type&&t.text==this.text&&t.imgHash==this.image},t.prototype.solve=function(t){this.answers.forEach((function(e,n){e.forEach((function(e){e.option.selected=e.option.innerText==t.answers[n],e.option.selected&&(e.select.value=e.option.value)}))}))},t}();e.TuwelMultianswer=r;var i=function(t){function e(e){var n=t.call(this,e)||this,o=[];return e.querySelectorAll(".feedbackspan").forEach((function(t){o.push(t.innerHTML.split("<br>")[1].split(": ")[1])})),n.correctAnswers=o,n}return o(e,t),e.prototype.toJSON=function(){return{type:"multianswer",text:this.text,imgHash:this.image,answers:this.correctAnswers}},e}(r);e.TuwelMultianswerSolved=i},746:function(t,e){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.TuwelMultichoiceSolved=e.TuwelMultichoice=void 0;var r=function(){function t(t){var e,n=this;this.question=t,this.text=t.querySelector(".qtext").innerText,this.image=null===(e=t.querySelector("img"))||void 0===e?void 0:e.src.slice(0,1e4),this.answers=[],t.querySelectorAll(".answer > div").forEach((function(t){n.answers.push({text:t.innerText,element:t.querySelector("input:nth-child(2)")})}))}return t.prototype.matches=function(t){return"multichoice"==t.type&&t.text==this.text&&t.imgHash==this.image},t.prototype.solve=function(t){this.answers.forEach((function(e){t.answers.some((function(t){return e.text==t}))&&e.element.click()}))},t}();e.TuwelMultichoice=r;var i=function(t){function e(e){var n=t.call(this,e)||this,o=e.querySelector(".rightanswer").innerText;return n.correctAnswers=[],n.answers.forEach((function(t){o.indexOf(t.text)>0&&n.correctAnswers.push(t.text)})),n}return o(e,t),e.prototype.toJSON=function(){return{type:"multichoice",text:this.text,imgHash:this.image,answers:this.correctAnswers}},e}(r);e.TuwelMultichoiceSolved=i},698:function(t,e,n){var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function s(t){try{c(o.next(t))}catch(t){i(t)}}function u(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,u)}c((o=o.apply(t,e||[])).next())}))},r=this&&this.__generator||function(t,e){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.setup=void 0;var i=n(203),s=n(498),u=n(746);e.setup=function(){var t=document.querySelector(".othernav"),e=document.createElement("a");e.href="#";var n=window.location.pathname.split("/").reverse()[0];"attempt.php"==n?(e.innerText="Load from tuwelsolutions",e.addEventListener("click",(function(){!function(){o(this,void 0,void 0,(function(){var t,e;return r(this,(function(n){switch(n.label){case 0:t=window.location.search.replace("?","").split("&").find((function(t){return t.indexOf("cmid")>=0})).replace("cmid=",""),e=void 0,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,(0,i.getSolutions)(t)];case 2:return e=n.sent(),[3,4];case 3:return n.sent(),console.timeLog("No solutions for this quiz :/"),[2];case 4:return console.log("found solutions for this quiz: ",e),document.querySelectorAll(".que").forEach((function(t){if(t.classList.contains("multichoice")){var n=new u.TuwelMultichoice(t);null==e||e.questions.forEach((function(t){n.matches(t)&&(n.solve(t),console.log("solved a question:",n))}))}if(t.classList.contains("multianswer")){var o=new s.TuwelMultianswer(t);null==e||e.questions.forEach((function(t){o.matches(t)&&(o.solve(t),console.log("solved a question:",o))}))}})),console.log("solved all known questions"),[2]}}))}))}()})),t.appendChild(e)):"review.php"==n&&(e.innerText="Upload to tuwelsolutions",e.addEventListener("click",(function(){!function(){o(this,void 0,void 0,(function(){var t,e,n;return r(this,(function(o){switch(o.label){case 0:return t=window.location.search.replace("?","").split("&").find((function(t){return t.indexOf("cmid")>=0})).replace("cmid=",""),e=[],document.querySelectorAll(".que").forEach((function(t){t.classList.contains("multichoice")?e.push(new u.TuwelMultichoiceSolved(t).toJSON()):t.classList.contains("multianswer")&&e.push(new s.TuwelMultianswerSolved(t).toJSON())})),n={quiz:t,questions:e},[4,(0,i.setSolution)(n)];case 1:return o.sent(),console.log("posted solutions to server: ",n),[2]}}))}))}(),e.removeAttribute("href"),e.innerText="Uploaded solutions",e.style.pointerEvents="none"})),t.appendChild(e)),console.log("tuwelsolutions v1.0.1 running")}}},e={},n=function n(o){var r=e[o];if(void 0!==r)return r.exports;var i=e[o]={exports:{}};return t[o].call(i.exports,i,i.exports,n),i.exports}(698);tws=n})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VUMsU0FBUyxlQUM1Qk0sRUFBVXhHLEtBQUssSUFBSTBFLEVBQWNWLHVCQUF1QmpDLEdBQVVnQyxVQUc3RGhDLEVBQVNrRSxVQUFVQyxTQUFTLGdCQUNqQ00sRUFBVXhHLEtBQUssSUFBSXlFLEVBQWM1Qyx1QkFBdUJFLEdBQVVnQyxhQUcxRTBDLEVBQWEsQ0FDVC9GLEtBQU00RSxFQUNOYyxVQUFXSSxHQUdSLENBQUMsR0FBYSxFQUFJaEMsRUFBTXBFLGFBQWFxRyxJQUNoRCxLQUFLLEVBSUQsT0FGQWxHLEVBQUdwQixPQUNIMkcsUUFBUUUsSUFBSSwrQkFBZ0NTLEdBQ3JDLENBQUMsVUFxQmhCQyxHQUNBN0IsRUFBVzhCLGdCQUFnQixRQUMzQjlCLEVBQVdwQixVQUFZLHFCQUN2Qm9CLEVBQVcrQixNQUFNQyxjQUFnQixVQUVyQ2xDLEVBQUk0QixZQUFZMUIsSUFFcEJpQixRQUFRRSxJQUFJLG9DQ2pLWmMsRUFBMkIsR0NFM0JDLEVEQ0osU0FBU0MsRUFBb0JDLEdBRTVCLElBQUlDLEVBQWVKLEVBQXlCRyxHQUM1QyxRQUFxQnBCLElBQWpCcUIsRUFDSCxPQUFPQSxFQUFhL0csUUFHckIsSUFBSWdILEVBQVNMLEVBQXlCRyxHQUFZLENBR2pEOUcsUUFBUyxJQU9WLE9BSEFpSCxFQUFvQkgsR0FBVXBILEtBQUtzSCxFQUFPaEgsUUFBU2dILEVBQVFBLEVBQU9oSCxRQUFTNkcsR0FHcEVHLEVBQU9oSCxRQ2xCVzZHLENBQW9CLEsiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90d3MvLi9zcmMvYXBpLnRzIiwid2VicGFjazovL3R3cy8uL3NyYy9tdWx0aWFuc3dlci50cyIsIndlYnBhY2s6Ly90d3MvLi9zcmMvbXVsdGljaG9pY2UudHMiLCJ3ZWJwYWNrOi8vdHdzLy4vc3JjL3R1d2Vsc29sdXRpb25zLnRzIiwid2VicGFjazovL3R3cy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly90d3Mvd2VicGFjay9zdGFydHVwIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xyXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn07XHJcbnZhciBfX2dlbmVyYXRvciA9ICh0aGlzICYmIHRoaXMuX19nZW5lcmF0b3IpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBib2R5KSB7XHJcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xyXG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcclxuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XHJcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcclxuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cclxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcclxuICAgIH1cclxufTtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5leHBvcnRzLnNldFNvbHV0aW9uID0gZXhwb3J0cy5nZXRTb2x1dGlvbnMgPSB2b2lkIDA7XHJcbmZ1bmN0aW9uIGdldFNvbHV0aW9ucyhpZCkge1xyXG4gICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciByZXNwb25zZSwgc29sdXRpb25zO1xyXG4gICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCBmZXRjaChcImh0dHBzOi8vdHV3ZWxzb2x1dGlvbi54ZXJ1cy5hdC9zb2x1dGlvbi9cIiArIGlkKV07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzcG9uc2UuanNvbigpXTtcclxuICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICBzb2x1dGlvbnMgPSBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHNvbHV0aW9uc107XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcbmV4cG9ydHMuZ2V0U29sdXRpb25zID0gZ2V0U29sdXRpb25zO1xyXG5mdW5jdGlvbiBzZXRTb2x1dGlvbihxdWl6KSB7XHJcbiAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIGZldGNoKCdodHRwczovL3R1d2Vsc29sdXRpb24ueGVydXMuYXQvc29sdXRpb24vc2F2ZS8nLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BVVCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocXVpeilcclxuICAgICAgICAgICAgICAgICAgICB9KV07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuZXhwb3J0cy5zZXRTb2x1dGlvbiA9IHNldFNvbHV0aW9uO1xyXG4iLCJcInVzZSBzdHJpY3RcIjtcclxudmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xyXG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xyXG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcclxuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxuICAgIH07XHJcbn0pKCk7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5UdXdlbE11bHRpYW5zd2VyU29sdmVkID0gZXhwb3J0cy5UdXdlbE11bHRpYW5zd2VyID0gdm9pZCAwO1xyXG4vKiogYmFzZSBjbGFzcyBmb3IgdHV3ZWwgbXVsdGlhbnN3ZXIgcXVlc3Rpb25zICovXHJcbnZhciBUdXdlbE11bHRpYW5zd2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gVHV3ZWxNdWx0aWFuc3dlcihxdWVzdGlvbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgIHRoaXMucXVlc3Rpb24gPSBxdWVzdGlvbjtcclxuICAgICAgICB2YXIgZm9ybXVsYXRpb24gPSBxdWVzdGlvbi5xdWVyeVNlbGVjdG9yKFwiLmZvcm11bGF0aW9uXCIpLmNsb25lTm9kZSh0cnVlKTtcclxuICAgICAgICBmb3JtdWxhdGlvbi5xdWVyeVNlbGVjdG9yQWxsKFwiLnN1YnF1ZXN0aW9uXCIpLmZvckVhY2goZnVuY3Rpb24gKHMpIHsgcmV0dXJuIHMucmVtb3ZlKCk7IH0pO1xyXG4gICAgICAgIHRoaXMudGV4dCA9IGZvcm11bGF0aW9uLnRleHRDb250ZW50O1xyXG4gICAgICAgIHRoaXMuaW1hZ2UgPSAoX2EgPSBxdWVzdGlvbi5xdWVyeVNlbGVjdG9yKFwiaW1nXCIpKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Euc3JjLnNsaWNlKDAsIDEwMDAwKTtcclxuICAgICAgICB0aGlzLmFuc3dlcnMgPSBbXTtcclxuICAgICAgICBxdWVzdGlvbi5xdWVyeVNlbGVjdG9yQWxsKFwiLnN1YnF1ZXN0aW9uIHNlbGVjdFwiKS5mb3JFYWNoKGZ1bmN0aW9uIChzZWxlY3QpIHtcclxuICAgICAgICAgICAgdmFyIG9wdHMgPSBbXTtcclxuICAgICAgICAgICAgc2VsZWN0LnF1ZXJ5U2VsZWN0b3JBbGwoXCJvcHRpb25cIikuZm9yRWFjaChmdW5jdGlvbiAob3B0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICBvcHRzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbjogb3B0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdDogc2VsZWN0XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIF90aGlzLmFuc3dlcnMucHVzaChvcHRzKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogZXZhbHVhdGVzIGlmIHRoaXMgcXVlc3Rpb24gaXMgZXF1YWwgdG8gYW5vdGhlclxyXG4gICAgICogQHBhcmFtIHF1ZXN0aW9uXHJcbiAgICAgKi9cclxuICAgIFR1d2VsTXVsdGlhbnN3ZXIucHJvdG90eXBlLm1hdGNoZXMgPSBmdW5jdGlvbiAocXVlc3Rpb24pIHtcclxuICAgICAgICByZXR1cm4gcXVlc3Rpb24udHlwZSA9PSBcIm11bHRpYW5zd2VyXCIgJiYgcXVlc3Rpb24udGV4dCA9PSB0aGlzLnRleHQgJiYgcXVlc3Rpb24uaW1nSGFzaCA9PSB0aGlzLmltYWdlO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogdGlja3MgdGhlIHByb3ZpZGVkIGNvcnJlY3Qgc29sdXRpb25zIG9mIGFuIHF1ZXN0aW9ucyBhbnN3ZXJcclxuICAgICAqIEBwYXJhbSBzb2x1dGlvbiB0aGUgc29sdXRpb25zIGZvciB0aGlzIHF1ZXN0aW9uXHJcbiAgICAgKi9cclxuICAgIFR1d2VsTXVsdGlhbnN3ZXIucHJvdG90eXBlLnNvbHZlID0gZnVuY3Rpb24gKHNvbHV0aW9uKSB7XHJcbiAgICAgICAgLyogbG9vcCB0aHJvdWdoIGF2YWlsYWJsZSBhbnN3ZXJzICovXHJcbiAgICAgICAgdGhpcy5hbnN3ZXJzLmZvckVhY2goZnVuY3Rpb24gKHN1YnF1ZXN0aW9uLCBpbmRleCkge1xyXG4gICAgICAgICAgICAvKiBzZXQgc2VsZWN0IHZhbHVlICovXHJcbiAgICAgICAgICAgIHN1YnF1ZXN0aW9uLmZvckVhY2goZnVuY3Rpb24gKHMpIHtcclxuICAgICAgICAgICAgICAgIHMub3B0aW9uLnNlbGVjdGVkID0gcy5vcHRpb24uaW5uZXJUZXh0ID09IHNvbHV0aW9uLmFuc3dlcnNbaW5kZXhdO1xyXG4gICAgICAgICAgICAgICAgaWYgKHMub3B0aW9uLnNlbGVjdGVkKVxyXG4gICAgICAgICAgICAgICAgICAgIHMuc2VsZWN0LnZhbHVlID0gcy5vcHRpb24udmFsdWU7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBUdXdlbE11bHRpYW5zd2VyO1xyXG59KCkpO1xyXG5leHBvcnRzLlR1d2VsTXVsdGlhbnN3ZXIgPSBUdXdlbE11bHRpYW5zd2VyO1xyXG4vKiogY2xhc3MgdG8gaGFuZGxlIGEgbXVsdGljaG9pY2UgcmVzdWx0ICovXHJcbnZhciBUdXdlbE11bHRpYW5zd2VyU29sdmVkID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgX19leHRlbmRzKFR1d2VsTXVsdGlhbnN3ZXJTb2x2ZWQsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBUdXdlbE11bHRpYW5zd2VyU29sdmVkKHF1ZXN0aW9uKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcXVlc3Rpb24pIHx8IHRoaXM7XHJcbiAgICAgICAgdmFyIHNvbHV0aW9uID0gW107XHJcbiAgICAgICAgcXVlc3Rpb24ucXVlcnlTZWxlY3RvckFsbChcIi5mZWVkYmFja3NwYW5cIikuZm9yRWFjaChmdW5jdGlvbiAoc3VicSkge1xyXG4gICAgICAgICAgICBzb2x1dGlvbi5wdXNoKHN1YnEuaW5uZXJIVE1MLnNwbGl0KFwiPGJyPlwiKVsxXS5zcGxpdChcIjogXCIpWzFdKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBfdGhpcy5jb3JyZWN0QW5zd2VycyA9IHNvbHV0aW9uO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogY29udmVydHMgdGhpcyBxdWVzdGlvbiB0byB0aGUgZGIganNvbiBpbnRlcmZhY2VcclxuICAgICAqIEByZXR1cm5zIHF1ZXN0aW9uIG9iamVjdFxyXG4gICAgICovXHJcbiAgICBUdXdlbE11bHRpYW5zd2VyU29sdmVkLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgdHlwZTogXCJtdWx0aWFuc3dlclwiLFxyXG4gICAgICAgICAgICB0ZXh0OiB0aGlzLnRleHQsXHJcbiAgICAgICAgICAgIGltZ0hhc2g6IHRoaXMuaW1hZ2UsXHJcbiAgICAgICAgICAgIGFuc3dlcnM6IHRoaXMuY29ycmVjdEFuc3dlcnNcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIHJldHVybiBUdXdlbE11bHRpYW5zd2VyU29sdmVkO1xyXG59KFR1d2VsTXVsdGlhbnN3ZXIpKTtcclxuZXhwb3J0cy5UdXdlbE11bHRpYW5zd2VyU29sdmVkID0gVHV3ZWxNdWx0aWFuc3dlclNvbHZlZDtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcclxuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcclxuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxyXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XHJcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbiAgICB9O1xyXG59KSgpO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmV4cG9ydHMuVHV3ZWxNdWx0aWNob2ljZVNvbHZlZCA9IGV4cG9ydHMuVHV3ZWxNdWx0aWNob2ljZSA9IHZvaWQgMDtcclxuLyoqIGJhc2UgY2xhc3MgZm9yIHR1d2VsIG11bHRpY2hvaWNlIHF1ZXN0aW9ucyAqL1xyXG52YXIgVHV3ZWxNdWx0aWNob2ljZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFR1d2VsTXVsdGljaG9pY2UocXVlc3Rpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBfYTtcclxuICAgICAgICB0aGlzLnF1ZXN0aW9uID0gcXVlc3Rpb247XHJcbiAgICAgICAgdGhpcy50ZXh0ID0gcXVlc3Rpb24ucXVlcnlTZWxlY3RvcihcIi5xdGV4dFwiKS5pbm5lclRleHQ7XHJcbiAgICAgICAgdGhpcy5pbWFnZSA9IChfYSA9IHF1ZXN0aW9uLnF1ZXJ5U2VsZWN0b3IoXCJpbWdcIikpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zcmMuc2xpY2UoMCwgMTAwMDApO1xyXG4gICAgICAgIHRoaXMuYW5zd2VycyA9IFtdO1xyXG4gICAgICAgIHF1ZXN0aW9uLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYW5zd2VyID4gZGl2XCIpLmZvckVhY2goZnVuY3Rpb24gKGFuc3dlcikge1xyXG4gICAgICAgICAgICBfdGhpcy5hbnN3ZXJzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgdGV4dDogYW5zd2VyLmlubmVyVGV4dCxcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQ6IGFuc3dlci5xdWVyeVNlbGVjdG9yKFwiaW5wdXQ6bnRoLWNoaWxkKDIpXCIpXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBldmFsdWF0ZXMgaWYgdGhpcyBxdWVzdGlvbiBpcyBlcXVhbCB0byBhbm90aGVyXHJcbiAgICAgKiBAcGFyYW0gcXVlc3Rpb25cclxuICAgICAqL1xyXG4gICAgVHV3ZWxNdWx0aWNob2ljZS5wcm90b3R5cGUubWF0Y2hlcyA9IGZ1bmN0aW9uIChxdWVzdGlvbikge1xyXG4gICAgICAgIHJldHVybiBxdWVzdGlvbi50eXBlID09IFwibXVsdGljaG9pY2VcIiAmJiBxdWVzdGlvbi50ZXh0ID09IHRoaXMudGV4dCAmJiBxdWVzdGlvbi5pbWdIYXNoID09IHRoaXMuaW1hZ2U7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiB0aWNrcyB0aGUgcHJvdmlkZWQgY29ycmVjdCBzb2x1dGlvbnMgb2YgYW4gcXVlc3Rpb25zIGFuc3dlclxyXG4gICAgICogQHBhcmFtIHNvbHV0aW9uIHRoZSBzb2x1dGlvbnMgZm9yIHRoaXMgcXVlc3Rpb25cclxuICAgICAqL1xyXG4gICAgVHV3ZWxNdWx0aWNob2ljZS5wcm90b3R5cGUuc29sdmUgPSBmdW5jdGlvbiAoc29sdXRpb24pIHtcclxuICAgICAgICAvKiBsb29wIHRocm91Z2ggYXZhaWxhYmxlIGFuc3dlcnMgKi9cclxuICAgICAgICB0aGlzLmFuc3dlcnMuZm9yRWFjaChmdW5jdGlvbiAoYW5zd2VyKSB7XHJcbiAgICAgICAgICAgIC8qIGlmIGFuc3dlciBpcyBpbiBjb3JyZWN0IGFuc3dlcnMsIGNsaWNrIGl0ICovXHJcbiAgICAgICAgICAgIGlmIChzb2x1dGlvbi5hbnN3ZXJzLnNvbWUoZnVuY3Rpb24gKHRleHQpIHsgcmV0dXJuIGFuc3dlci50ZXh0ID09IHRleHQ7IH0pKSB7XHJcbiAgICAgICAgICAgICAgICBhbnN3ZXIuZWxlbWVudC5jbGljaygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFR1d2VsTXVsdGljaG9pY2U7XHJcbn0oKSk7XHJcbmV4cG9ydHMuVHV3ZWxNdWx0aWNob2ljZSA9IFR1d2VsTXVsdGljaG9pY2U7XHJcbi8qKiBjbGFzcyB0byBoYW5kbGUgYSBtdWx0aWNob2ljZSByZXN1bHQgKi9cclxudmFyIFR1d2VsTXVsdGljaG9pY2VTb2x2ZWQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICBfX2V4dGVuZHMoVHV3ZWxNdWx0aWNob2ljZVNvbHZlZCwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIFR1d2VsTXVsdGljaG9pY2VTb2x2ZWQocXVlc3Rpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBxdWVzdGlvbikgfHwgdGhpcztcclxuICAgICAgICB2YXIgc29sdXRpb24gPSBxdWVzdGlvbi5xdWVyeVNlbGVjdG9yKFwiLnJpZ2h0YW5zd2VyXCIpLmlubmVyVGV4dDtcclxuICAgICAgICBfdGhpcy5jb3JyZWN0QW5zd2VycyA9IFtdO1xyXG4gICAgICAgIF90aGlzLmFuc3dlcnMuZm9yRWFjaChmdW5jdGlvbiAoYW5zd2VyKSB7XHJcbiAgICAgICAgICAgIGlmIChzb2x1dGlvbi5pbmRleE9mKGFuc3dlci50ZXh0KSA+IDApXHJcbiAgICAgICAgICAgICAgICBfdGhpcy5jb3JyZWN0QW5zd2Vycy5wdXNoKGFuc3dlci50ZXh0KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIGNvbnZlcnRzIHRoaXMgcXVlc3Rpb24gdG8gdGhlIGRiIGpzb24gaW50ZXJmYWNlXHJcbiAgICAgKiBAcmV0dXJucyBxdWVzdGlvbiBvYmplY3RcclxuICAgICAqL1xyXG4gICAgVHV3ZWxNdWx0aWNob2ljZVNvbHZlZC5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHR5cGU6IFwibXVsdGljaG9pY2VcIixcclxuICAgICAgICAgICAgdGV4dDogdGhpcy50ZXh0LFxyXG4gICAgICAgICAgICBpbWdIYXNoOiB0aGlzLmltYWdlLFxyXG4gICAgICAgICAgICBhbnN3ZXJzOiB0aGlzLmNvcnJlY3RBbnN3ZXJzXHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gVHV3ZWxNdWx0aWNob2ljZVNvbHZlZDtcclxufShUdXdlbE11bHRpY2hvaWNlKSk7XHJcbmV4cG9ydHMuVHV3ZWxNdWx0aWNob2ljZVNvbHZlZCA9IFR1d2VsTXVsdGljaG9pY2VTb2x2ZWQ7XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn07XHJcbnZhciBfX2dlbmVyYXRvciA9ICh0aGlzICYmIHRoaXMuX19nZW5lcmF0b3IpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBib2R5KSB7XHJcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xyXG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcclxuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XHJcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcclxuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cclxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcclxuICAgIH1cclxufTtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5leHBvcnRzLnNldHVwID0gdm9pZCAwO1xyXG52YXIgYXBpXzEgPSByZXF1aXJlKFwiLi9hcGlcIik7XHJcbnZhciBtdWx0aWFuc3dlcl8xID0gcmVxdWlyZShcIi4vbXVsdGlhbnN3ZXJcIik7XHJcbnZhciBtdWx0aWNob2ljZV8xID0gcmVxdWlyZShcIi4vbXVsdGljaG9pY2VcIik7XHJcbmZ1bmN0aW9uIHNvbHZlUXVpeigpIHtcclxuICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgcXVpeklELCBjdXJyZW50U29sdXRpb24sIF9hO1xyXG4gICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2IpIHtcclxuICAgICAgICAgICAgc3dpdGNoIChfYi5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgIHF1aXpJRCA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2hcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoXCI/XCIsIFwiXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zcGxpdChcIiZcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoZnVuY3Rpb24gKHBhcmFtKSB7IHJldHVybiBwYXJhbS5pbmRleE9mKFwiY21pZFwiKSA+PSAwOyB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZShcImNtaWQ9XCIsIFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTb2x1dGlvbiA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgICAgICBfYi5sYWJlbCA9IDE7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgX2IudHJ5cy5wdXNoKFsxLCAzLCAsIDRdKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCAoMCwgYXBpXzEuZ2V0U29sdXRpb25zKShxdWl6SUQpXTtcclxuICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50U29sdXRpb24gPSBfYi5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgX2EgPSBfYi5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS50aW1lTG9nKFwiTm8gc29sdXRpb25zIGZvciB0aGlzIHF1aXogOi9cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OlxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZm91bmQgc29sdXRpb25zIGZvciB0aGlzIHF1aXo6IFwiLCBjdXJyZW50U29sdXRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGdldCBxdWVzdGlvbnMgZnJvbSBkb2N1bWVudCBhbmQgc29sdmUgdGhlbVxyXG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucXVlXCIpLmZvckVhY2goZnVuY3Rpb24gKHF1ZXN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlmIGl0J3MgYSBtdWx0aXBsZSBjaG9pY2UgcXVlc3Rpb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHF1ZXN0aW9uLmNsYXNzTGlzdC5jb250YWlucyhcIm11bHRpY2hvaWNlXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2hlY2tRdWVzdGlvbl8xID0gbmV3IG11bHRpY2hvaWNlXzEuVHV3ZWxNdWx0aWNob2ljZShxdWVzdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzZWFyY2ggZm9yIG1hdGNoaW5nIHNvbHV0aW9uc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFNvbHV0aW9uID09PSBudWxsIHx8IGN1cnJlbnRTb2x1dGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogY3VycmVudFNvbHV0aW9uLnF1ZXN0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChzb2x1dGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGVja1F1ZXN0aW9uXzEubWF0Y2hlcyhzb2x1dGlvbikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tRdWVzdGlvbl8xLnNvbHZlKHNvbHV0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJzb2x2ZWQgYSBxdWVzdGlvbjpcIiwgY2hlY2tRdWVzdGlvbl8xKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiBpdCdzIGEgbXVsdGlhbnN3ZXIgcXVlc3Rpb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHF1ZXN0aW9uLmNsYXNzTGlzdC5jb250YWlucyhcIm11bHRpYW5zd2VyXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0cXVlc3Rpb25fMSA9IG5ldyBtdWx0aWFuc3dlcl8xLlR1d2VsTXVsdGlhbnN3ZXIocXVlc3Rpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VhcmNoIGZvciBtYXRjaGluZyBzb2x1dGlvbnNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTb2x1dGlvbiA9PT0gbnVsbCB8fCBjdXJyZW50U29sdXRpb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IGN1cnJlbnRTb2x1dGlvbi5xdWVzdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoc29sdXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0cXVlc3Rpb25fMS5tYXRjaGVzKHNvbHV0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RxdWVzdGlvbl8xLnNvbHZlKHNvbHV0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJzb2x2ZWQgYSBxdWVzdGlvbjpcIiwgc2VsZWN0cXVlc3Rpb25fMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInNvbHZlZCBhbGwga25vd24gcXVlc3Rpb25zXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuLyoqXHJcbiAqIFByb2Nlc3MgYSBxdWl6IHJlc3VsdCBvbiB0aGUgXCJUVVdFTCByZXN1bHQgcGFnZVwiXHJcbiAqIGdldHMgdGhlIGNvcnJlY3QgYW5zd2VycywgbWVyZ2VzIHdpdGggY3VycmVudCBhbnN3ZXJzIG9uIHRoZSBzZXJ2ZXIgYW5kIHBvc3RzIHRoZSBtZXJnZVxyXG4gKi9cclxuZnVuY3Rpb24gcHJvY2Vzc1F1aXpSZXN1bHQoKSB7XHJcbiAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHF1aXpJRCwgc29sdXRpb25zLCBzb2x2ZWRRdWl6O1xyXG4gICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgIHF1aXpJRCA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2hcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoXCI/XCIsIFwiXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zcGxpdChcIiZcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoZnVuY3Rpb24gKHBhcmFtKSB7IHJldHVybiBwYXJhbS5pbmRleE9mKFwiY21pZFwiKSA+PSAwOyB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZShcImNtaWQ9XCIsIFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNvbHV0aW9ucyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucXVlXCIpLmZvckVhY2goZnVuY3Rpb24gKHF1ZXN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlmIGl0J3MgYSBtdWx0aXBsZSBjaG9pY2UgcXVlc3Rpb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHF1ZXN0aW9uLmNsYXNzTGlzdC5jb250YWlucyhcIm11bHRpY2hvaWNlXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb2x1dGlvbnMucHVzaChuZXcgbXVsdGljaG9pY2VfMS5UdXdlbE11bHRpY2hvaWNlU29sdmVkKHF1ZXN0aW9uKS50b0pTT04oKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgaXQncyBhIHNlbGVjdCBxdWVzdGlvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChxdWVzdGlvbi5jbGFzc0xpc3QuY29udGFpbnMoXCJtdWx0aWFuc3dlclwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc29sdXRpb25zLnB1c2gobmV3IG11bHRpYW5zd2VyXzEuVHV3ZWxNdWx0aWFuc3dlclNvbHZlZChxdWVzdGlvbikudG9KU09OKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgc29sdmVkUXVpeiA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcXVpejogcXVpeklELFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWVzdGlvbnM6IHNvbHV0aW9uc1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcG9zdCB0byBzZXJ2ZXJcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCAoMCwgYXBpXzEuc2V0U29sdXRpb24pKHNvbHZlZFF1aXopXTtcclxuICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAvLyBwb3N0IHRvIHNlcnZlclxyXG4gICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInBvc3RlZCBzb2x1dGlvbnMgdG8gc2VydmVyOiBcIiwgc29sdmVkUXVpeik7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufVxyXG4vKiogY29ubmVjdHMgdHV3ZWxzb2x1dGlvbiBmdW5jdGlvbnMgdG8gdGhlIFVJICovXHJcbmZ1bmN0aW9uIHNldHVwKCkge1xyXG4gICAgdmFyIG5hdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIub3RoZXJuYXZcIik7XHJcbiAgICB2YXIgYWN0aW9uRWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhXCIpO1xyXG4gICAgYWN0aW9uRWxlbS5ocmVmID0gXCIjXCI7XHJcbiAgICB2YXIgbW9kZSA9IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5zcGxpdChcIi9cIikucmV2ZXJzZSgpWzBdO1xyXG4gICAgaWYgKG1vZGUgPT0gXCJhdHRlbXB0LnBocFwiKSB7XHJcbiAgICAgICAgYWN0aW9uRWxlbS5pbm5lclRleHQgPSBcIkxvYWQgZnJvbSB0dXdlbHNvbHV0aW9uc1wiO1xyXG4gICAgICAgIGFjdGlvbkVsZW0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgc29sdmVRdWl6KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgbmF2LmFwcGVuZENoaWxkKGFjdGlvbkVsZW0pO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAobW9kZSA9PSBcInJldmlldy5waHBcIikge1xyXG4gICAgICAgIGFjdGlvbkVsZW0uaW5uZXJUZXh0ID0gXCJVcGxvYWQgdG8gdHV3ZWxzb2x1dGlvbnNcIjtcclxuICAgICAgICBhY3Rpb25FbGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHByb2Nlc3NRdWl6UmVzdWx0KCk7XHJcbiAgICAgICAgICAgIGFjdGlvbkVsZW0ucmVtb3ZlQXR0cmlidXRlKFwiaHJlZlwiKTtcclxuICAgICAgICAgICAgYWN0aW9uRWxlbS5pbm5lclRleHQgPSBcIlVwbG9hZGVkIHNvbHV0aW9uc1wiO1xyXG4gICAgICAgICAgICBhY3Rpb25FbGVtLnN0eWxlLnBvaW50ZXJFdmVudHMgPSBcIm5vbmVcIjtcclxuICAgICAgICB9KTtcclxuICAgICAgICBuYXYuYXBwZW5kQ2hpbGQoYWN0aW9uRWxlbSk7XHJcbiAgICB9XHJcbiAgICBjb25zb2xlLmxvZyhcInR1d2Vsc29sdXRpb25zIHYxLjAuMSBydW5uaW5nXCIpO1xyXG59XHJcbmV4cG9ydHMuc2V0dXAgPSBzZXR1cDtcclxuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIHN0YXJ0dXBcbi8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLy8gVGhpcyBlbnRyeSBtb2R1bGUgaXMgcmVmZXJlbmNlZCBieSBvdGhlciBtb2R1bGVzIHNvIGl0IGNhbid0IGJlIGlubGluZWRcbnZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2OTgpO1xuIl0sIm5hbWVzIjpbIl9fYXdhaXRlciIsInRoaXMiLCJ0aGlzQXJnIiwiX2FyZ3VtZW50cyIsIlAiLCJnZW5lcmF0b3IiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImZ1bGZpbGxlZCIsInZhbHVlIiwic3RlcCIsIm5leHQiLCJlIiwicmVqZWN0ZWQiLCJyZXN1bHQiLCJkb25lIiwidGhlbiIsImFwcGx5IiwiX19nZW5lcmF0b3IiLCJib2R5IiwiZiIsInkiLCJ0IiwiZyIsIl8iLCJsYWJlbCIsInNlbnQiLCJ0cnlzIiwib3BzIiwidmVyYiIsIlN5bWJvbCIsIml0ZXJhdG9yIiwibiIsInYiLCJvcCIsIlR5cGVFcnJvciIsImNhbGwiLCJwb3AiLCJsZW5ndGgiLCJwdXNoIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJleHBvcnRzIiwic2V0U29sdXRpb24iLCJnZXRTb2x1dGlvbnMiLCJpZCIsIl9hIiwiZmV0Y2giLCJqc29uIiwicXVpeiIsIm1ldGhvZCIsImhlYWRlcnMiLCJKU09OIiwic3RyaW5naWZ5IiwiZXh0ZW5kU3RhdGljcyIsIl9fZXh0ZW5kcyIsImQiLCJiIiwic2V0UHJvdG90eXBlT2YiLCJfX3Byb3RvX18iLCJBcnJheSIsInAiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsIlN0cmluZyIsIl9fIiwiY29uc3RydWN0b3IiLCJjcmVhdGUiLCJUdXdlbE11bHRpYW5zd2VyU29sdmVkIiwiVHV3ZWxNdWx0aWFuc3dlciIsInF1ZXN0aW9uIiwiX3RoaXMiLCJmb3JtdWxhdGlvbiIsInF1ZXJ5U2VsZWN0b3IiLCJjbG9uZU5vZGUiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsInMiLCJyZW1vdmUiLCJ0ZXh0IiwidGV4dENvbnRlbnQiLCJpbWFnZSIsInNyYyIsInNsaWNlIiwiYW5zd2VycyIsInNlbGVjdCIsIm9wdHMiLCJvcHRpb24iLCJtYXRjaGVzIiwidHlwZSIsImltZ0hhc2giLCJzb2x2ZSIsInNvbHV0aW9uIiwic3VicXVlc3Rpb24iLCJpbmRleCIsInNlbGVjdGVkIiwiaW5uZXJUZXh0IiwiX3N1cGVyIiwic3VicSIsImlubmVySFRNTCIsInNwbGl0IiwiY29ycmVjdEFuc3dlcnMiLCJ0b0pTT04iLCJUdXdlbE11bHRpY2hvaWNlU29sdmVkIiwiVHV3ZWxNdWx0aWNob2ljZSIsImFuc3dlciIsImVsZW1lbnQiLCJzb21lIiwiY2xpY2siLCJpbmRleE9mIiwic2V0dXAiLCJhcGlfMSIsIm11bHRpYW5zd2VyXzEiLCJtdWx0aWNob2ljZV8xIiwibmF2IiwiZG9jdW1lbnQiLCJhY3Rpb25FbGVtIiwiY3JlYXRlRWxlbWVudCIsImhyZWYiLCJtb2RlIiwid2luZG93IiwibG9jYXRpb24iLCJwYXRobmFtZSIsInJldmVyc2UiLCJhZGRFdmVudExpc3RlbmVyIiwicXVpeklEIiwiY3VycmVudFNvbHV0aW9uIiwiX2IiLCJzZWFyY2giLCJyZXBsYWNlIiwiZmluZCIsInBhcmFtIiwidW5kZWZpbmVkIiwiY29uc29sZSIsInRpbWVMb2ciLCJsb2ciLCJjbGFzc0xpc3QiLCJjb250YWlucyIsImNoZWNrUXVlc3Rpb25fMSIsInF1ZXN0aW9ucyIsInNlbGVjdHF1ZXN0aW9uXzEiLCJzb2x2ZVF1aXoiLCJhcHBlbmRDaGlsZCIsInNvbHV0aW9ucyIsInNvbHZlZFF1aXoiLCJwcm9jZXNzUXVpelJlc3VsdCIsInJlbW92ZUF0dHJpYnV0ZSIsInN0eWxlIiwicG9pbnRlckV2ZW50cyIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19leHBvcnRzX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIl0sInNvdXJjZVJvb3QiOiIifQ==